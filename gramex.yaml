# Generated by gramex init 1.61.0 (don't delete this line)
# on 2020-07-14 by Pratap Vardhan <pratap.vardhan@gramener.com>

# Configurations for app: process-monitor
# ----------------------------------------------------------------------------
url:
  process-monitor-home:
    pattern: /$YAMLURL/
    handler: FileHandler
    kwargs:
      path: $YAMLPATH/index.html
      template: true

  process-monitor-public-page:
    pattern: /$YAMLURL/(help|code)
    handler: FileHandler
    kwargs:
      path: $YAMLPATH/*.html
      template: true

  process-monitor-page:
    pattern: /$YAMLURL/(monitor|mobile|predictor|simulator)
    handler: FileHandler
    kwargs:
      path: $YAMLPATH/*.html
      template: true
      headers:
        # Templates may have user-specific content. Cache privately.
        # Keep max-age small (in case we log out & log in as another user.)
        Cache-Control: private, max-age=1
    cache: {expiry: {duration: 1}}

  process-monitor-data:
    pattern: /$YAMLURL/(data|datasimulate)
    handler: FormHandler
    kwargs:
      batch:
        url: $YAMLPATH/data.xlsx
        sheet_name: batch
      summary:
        url: $YAMLPATH/data.xlsx
        sheet_name: batchsummary
      modify: process_monitor.classify(data, handler)

  process-monitor-classify:
    pattern: /$YAMLURL/(classify)
    handler: ModelHandler
    kwargs:
      path: $GRAMEXDATA/apps/processmonitor/

  process-monitor-train:
    pattern: /$YAMLURL/train
    handler: FunctionHandler
    kwargs:
      function: process_monitor.train(handler, r'$YAMLPATH/data.xlsx', sheet_name='input')
      headers:
        Content-Type: application/json

  process-monitor-logout:
    pattern: /$YAMLURL/logout/
    handler: LogoutHandler

# Gramex init configurations for app: process-monitor
# ----------------------------------------------------------------------------
import:
  # /ui/ has Gramex UI components -- use this like the node_modules/ directory
  ui:
    path: $GRAMEXAPPS/ui/gramex.yaml
    YAMLURL: $YAMLURL/ui/
