# Generated by gramex init 1.61.0 (don't delete this line)
# on 2020-07-14 by Pratap Vardhan <pratap.vardhan@gramener.com>

# Configurations for app: process-monitor
# ----------------------------------------------------------------------------
url:
  process-monitor-home:
    pattern: /$YAMLURL/
    handler: FileHandler
    kwargs:
      path: $YAMLPATH/index.html
      template: true

  process-monitor-public-page:
    pattern: /$YAMLURL/(help|code)
    handler: FileHandler
    kwargs:
      path: $YAMLPATH/*.html
      template: true

  process-monitor-page:
    pattern: /$YAMLURL/(monitor|mobile|predictor|simulator)
    handler: FileHandler
    kwargs:
      path: $YAMLPATH/*.html
      template: true
      headers:
        # Templates may have user-specific content. Cache privately.
        # Keep max-age small (in case we log out & log in as another user.)
        Cache-Control: private, max-age=1
    cache: {expiry: {duration: 1}}

  process-monitor-data:
    pattern: /$YAMLURL/(data|datasimulate)
    handler: FormHandler
    kwargs:
      batch:
        url: $YAMLPATH/data_batch.csv
      summary:
        url: $YAMLPATH/data_summary.csv
      modify: process_monitor.classify(data, handler)

  process-monitor-classify:
    pattern: /$YAMLURL/classify
    handler: MLHandler
    kwargs:
      template: mlhandler-template.html
      data:
        url: $YAMLPATH/data_input.csv
      model:
        class: LogisticRegression
        path: $YAMLPATH/process-monitor-classify.pkl
        target_col: Outcome
        exclude: [Batch Number]
        cats:
          - "Material A"
          - "Material B"
          - "Solvent Amt"
          - "Catalyzer Type"
        nums:
          - "Avg Reactor Temperature"
          - "Avg Reaction Time (min)"
          - "Avg Crystallizer Cooling Rate"
          - "Avg Crystallizer Stirring Speed"
          - "Avg Dryer Cycle Time (min)"
          - "Avg Dryer Speed"
          - "Avg Dryer Temperature"
          - "Avg Crushing speed"
          - "Avg Crushing time (min)"

  process-monitor-logout:
    pattern: /$YAMLURL/logout/
    handler: LogoutHandler

# Gramex init configurations for app: process-monitor
# ----------------------------------------------------------------------------
import:
  # /ui/ has Gramex UI components -- use this like the node_modules/ directory
  ui:
    path: $GRAMEXAPPS/ui/gramex.yaml
    YAMLURL: $YAMLURL/ui/
